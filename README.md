# CarrotDefence
A game mainly written in C++, and based on the FantasyCarrot as the prototype. NJU programming training project in 2024 fall.

# 项目名称: **塔防游戏 - 保卫萝卜风格**

  

## 项目概述

该项目是基于C++和Qt框架开发的一款塔防游戏，玩家需要在地图上放置不同的防御塔，防止敌人到达目标（萝卜）。游戏需要有多个关卡和多种塔以及敌人类型，并提供升级塔、防守、计分等功能。

  

## 系统架构

  

### 1. 游戏引擎与框架

- **开发语言**: C++

- **UI框架**: Qt (Qt Widgets)

- **图形库**: QGraphicsView, QGraphicsScene 用于场景管理

- **声音库**: Qt Multimedia

  

## 类设计

  

### 1. **GameController**
- **继承自:** QWidget
- **功能**: 管理游戏流程，初始化场景、加载关卡、控制游戏节奏。
- **主要成员变量**:

     - `currentLevel`: 当前关卡

     - `lives`: 玩家生命值

     - `score`: 玩家得分

   - **主要方法**:

     - `startGame()`: 开始游戏

     - `endGame()`: 结束游戏

     - `pauseGame()`: 暂停游戏

     - `resumeGame()`: 恢复游戏

  

### 2. **LevelManager**

   - **功能**: 管理关卡配置和进度。

   - **主要成员变量**:

     - `levelData`: 每个关卡的地图和敌人信息

   - **主要方法**:

     - `loadLevel(int level)`: 加载指定关卡

     - `nextLevel()`: 进入下一关

  

### 3. **Tower (防御塔)**

   - **功能**: 定义不同的防御塔类型。

   - **主要成员变量**:

     - `damage`: 攻击力

     - `range`: 攻击范围

     - `attackSpeed`: 攻击速度

     - `cost`: 购买或升级的花费

   - **主要方法**:

     - `attack()`: 攻击敌人

     - `upgrade()`: 升级塔的属性

     - `sell()`: 出售塔

  

### 4. **Enemy (敌人)**

   - **功能**: 定义敌人的属性和行为。

   - **主要成员变量**:

     - `health`: 生命值

     - `speed`: 移动速度

     - `reward`: 击败后给玩家的奖励（金币）

   - **主要方法**:

     - `move()`: 移动到下一个位置

     - `takeDamage(int damage)`: 接受伤害

     - `isAlive()`: 检查敌人是否存活

  

### 5. **Projectile (投射物)**

   - **功能**: 定义防御塔发射的子弹或魔法攻击。

   - **主要成员变量**:

     - `speed`: 移动速度

     - `damage`: 伤害

   - **主要方法**:

     - `move()`: 更新投射物的位置

     - `hitTarget()`: 命中敌人时触发的效果

  

### 6. **Map (地图)**

   - **功能**: 定义关卡的地图布局。

   - **主要成员变量**:

     - `grid`: 二维数组表示地图的网格（包含障碍物和道路）

   - **主要方法**:

     - `loadMap(int level)`: 根据关卡载入地图

     - `isWalkable(int x, int y)`: 检查某个位置是否可行走

  

### 7. **Player (玩家)**

   - **功能**: 定义玩家的状态。

   - **主要成员变量**:

     - `money`: 玩家拥有的金币数

     - `lives`: 玩家剩余的生命数

   - **主要方法**:

     - `spendMoney(int amount)`: 消耗金币

     - `earnMoney(int amount)`: 获得金币

     - `loseLife()`: 玩家失去生命

  

### 8. **UIManager**

   - **功能**: 管理游戏的用户界面，包括主菜单、关卡选择、游戏内UI等。

   - **主要成员变量**:

     - `startMenu`: 启动游戏的菜单界面

     - `pauseMenu`: 游戏暂停时的界面

     - `scoreDisplay`: 显示当前得分

   - **主要方法**:

     - `showMenu()`: 显示菜单

     - `updateScore(int newScore)`: 更新玩家得分

  

## 功能需求

  

1. **防御塔功能**:

   - 玩家可以在特定位置放置防御塔。

   - 防御塔能够自动攻击进入其射程的敌人。

   - 防御塔可以升级，提升攻击力和攻击范围。

  

2. **敌人生成与路径规划**:

   - 敌人会按照预设路径向萝卜移动。

   - 敌人有多种类型，具备不同的速度、血量和能力。

  

3. **地图设计**:

   - 每个关卡有独特的地图设计，包括路径和障碍物。

   - 玩家只能在特定的空地上放置防御塔。

  

4. **玩家金币与生命值**:

   - 击败敌人会获得金币，用于购买和升级防御塔。

   - 敌人到达目标会减少玩家的生命值，生命值为零时游戏结束。

  

5. **关卡系统**:

   - 游戏具有多个关卡，每个关卡敌人数量和强度逐渐增加。

   - 玩家通关后进入下一关，失败可以重试。

  

6. **游戏菜单与设置**:

   - 主菜单包括开始游戏、选择关卡、设置和退出等功能。

   - 设置选项允许玩家调整音效、难度等游戏参数。

  

## 开发计划

  

1. **第1阶段**: 核心游戏玩法开发

   - 完成基本的地图、敌人和塔的交互逻辑。

   - 实现敌人路径规划与防御塔攻击功能。

  

2. **第2阶段**: UI与关卡设计

   - 实现用户界面，菜单系统，关卡选择界面。

   - 设计并实现多个关卡和地图。

  

3. **第3阶段**: 完善与测试

   - 添加音效和游戏效果。

   - 修复bug，并进行优化。

  

4. **第4阶段**: 发布与优化

   - 完成最终版本，优化性能，发布游戏。